<%= form_with model: customer, class: "space-y-8", local: true, data: { controller: "customer-form" } do |f| %>
  <% if customer.errors.any? %>
    <div class="alert-error">
      <h3 class="text-sm font-medium">Se encontraron errores:</h3>
      <div class="mt-2 text-sm">
        <ul role="list" class="list-disc space-y-1 pl-5">
          <% customer.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
    </div>
  <% end %>

  <div class="card">
    <h3 class="text-lg font-medium leading-6 text-foreground">Informacion del Cliente</h3>
    <p class="mt-1 text-sm text-muted-foreground">Datos principales del cliente.</p>

    <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">

      <div class="sm:col-span-4">
        <%= f.label :name, "Nombre del Cliente", class: "form-label" %>
        <%= f.text_field :name, class: "form-input", required: true, placeholder: "Ej: Juan Perez / Empresa ABC S.A.C." %>
      </div>

      <div class="sm:col-span-2">
        <%= f.label :tax_id_type, "Tipo de Documento", class: "form-label" %>
        <%= f.select :tax_id_type,
            options_for_select([
              ["Ninguno", "no_document"],
              ["RUC", "ruc"],
              ["DNI", "dni"]
            ], customer.tax_id_type || "no_document"),
            {},
            class: "form-input",
            data: { customer_form_target: "taxIdType", action: "change->customer-form#toggleTaxId" } %>
      </div>

      <div class="sm:col-span-3 <%= 'hidden' if customer.no_document? || customer.tax_id_type.nil? %>" data-customer-form-target="taxIdContainer">
        <%= f.label :tax_id, "Numero de Documento", class: "form-label" %>
        <%= f.text_field :tax_id, class: "form-input", placeholder: "RUC (11 digitos) o DNI (8 digitos)" %>
      </div>

      <div class="sm:col-span-3">
        <%= f.label :address, class: "form-label" do %>
          Direccion <span class="text-muted-foreground font-normal">(opcional)</span>
        <% end %>
        <%= f.text_field :address, class: "form-input", placeholder: "Av. Principal 123" %>
      </div>

    </div>
  </div>

  <div class="card">
    <h3 class="text-lg font-medium leading-6 text-foreground">Informacion de Contacto</h3>
    <p class="mt-1 text-sm text-muted-foreground">Datos para comunicarte con el cliente.</p>

    <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">

      <div class="sm:col-span-3">
        <%= f.label :email, class: "form-label" do %>
          Correo Electronico <span class="text-muted-foreground font-normal">(opcional)</span>
        <% end %>
        <%= f.email_field :email, class: "form-input", placeholder: "cliente@ejemplo.com" %>
      </div>

      <div class="sm:col-span-3">
        <%= f.label :phone_number, class: "form-label" do %>
          Numero de Telefono <span class="text-muted-foreground font-normal">(opcional)</span>
        <% end %>
        <%= f.text_field :phone_number, class: "form-input", placeholder: "987654321" %>
        <p class="mt-1 text-xs text-muted-foreground">Formato: 9 digitos para celular</p>
      </div>

    </div>
  </div>

  <div class="card">
    <h3 class="text-lg font-medium leading-6 text-foreground">Condiciones Comerciales</h3>
    <p class="mt-1 text-sm text-muted-foreground">Configuracion de credito y pagos.</p>

    <div class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6">

      <div class="sm:col-span-3">
        <%= f.label :credit_limit, "Limite de Credito (S/)", class: "form-label" %>
        <%= f.number_field :credit_limit, class: "form-input", step: "0.01", min: 0, placeholder: "0.00" %>
        <p class="mt-1 text-xs text-muted-foreground">Monto maximo de credito permitido. 0 = sin credito</p>
      </div>

      <div class="sm:col-span-3">
        <%= f.label :payment_terms, "Dias de Credito", class: "form-label" %>
        <%= f.number_field :payment_terms, class: "form-input", step: 1, min: 0, placeholder: "0" %>
        <p class="mt-1 text-xs text-muted-foreground">Plazo de pago en dias. 0 = solo contado</p>
      </div>

    </div>
  </div>

  <div class="flex justify-end gap-3">
    <%= link_to "Cancelar", customers_path, class: "btn-secondary" %>
    <%= f.submit customer.persisted? ? "Actualizar Cliente" : "Crear Cliente", class: "btn-primary cursor-pointer" %>
  </div>
<% end %>
