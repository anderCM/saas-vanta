<aside
  data-controller="sidebar"
  data-sidebar-collapsed-class="sidebar-collapsed"
  class="sidebar group"
  id="sidebar"
>
  <div class="sidebar-top">
    <div class="sidebar-logo">
      <div class="sidebar-logo-group">
        <div class="sidebar-logo-icon">
          <img src="/logo-vanta-fox.png" alt="VANTA" class="w-full h-full object-contain">
        </div>
        <span class="sidebar-logo-text" data-sidebar-target="collapsible">VANTA</span>
      </div>
      <button
        type="button"
        data-action="click->sidebar#toggle"
        class="sidebar-collapse-btn"
        title="Colapsar/Expandir menú"
      >
        <span data-sidebar-target="collapseIcon">
          <%= sidebar_icon("chevrons-left", class: "w-[18px] h-[18px]") %>
        </span>
        <span data-sidebar-target="expandIcon" class="hidden">
          <%= sidebar_icon("chevrons-right", class: "w-[18px] h-[18px]") %>
        </span>
      </button>
    </div>

    <nav class="sidebar-nav">
      <%= sidebar_link_to "Dashboard", root_path, icon: "layout-dashboard" %>

      <% if current_enterprise.present? %>
        <%= sidebar_link_to "Productos", products_path, icon: "package" %>
        <%= sidebar_link_to "Proveedores", providers_path, icon: "truck" %>
        <%= sidebar_link_to "Clientes", customers_path, icon: "users" %>
        <%= sidebar_link_to "Importaciones", bulk_imports_path, icon: "upload" %>
        <%= sidebar_link_to "Cotizaciones", customer_quotes_path, icon: "file-text" %>
        <%= sidebar_link_to "Ordenes de compra", purchase_orders_path, icon: "package" %>
      <% end %>

      <% if current_enterprise.present? && policy(User).index? %>
        <%= sidebar_link_to "Usuarios", users_path, icon: "users" %>
      <% end %>

      <% if Current.user&.super_admin? %>
        <%= sidebar_link_to "Empresas", new_admin_enterprise_path, icon: "building-2" %>
      <% end %>
    </nav>
  </div>

  <div class="sidebar-bottom">
    <button type="button" class="sidebar-theme-toggle" id="theme-toggle" title="Cambiar tema">
      <span class="theme-icon-dark">
        <%= sidebar_icon("moon", class: "w-5 h-5 flex-shrink-0") %>
      </span>
      <span class="theme-icon-light hidden">
        <%= sidebar_icon("sun", class: "w-5 h-5 flex-shrink-0") %>
      </span>
      <span class="sidebar-theme-toggle-text" data-sidebar-target="collapsible">
        <span class="theme-text-dark">Tema Oscuro</span>
        <span class="theme-text-light hidden">Tema Claro</span>
      </span>
    </button>

    <% if current_enterprise.present? && policy(current_enterprise).edit? %>
      <%= sidebar_link_to "Mi Empresa", edit_enterprise_path(current_enterprise), icon: "building-2" %>
    <% end %>

    <div class="sidebar-user">
      <div class="sidebar-user-avatar">
        <span class="text-sm font-semibold text-white">
          <%= Current.user&.first_name&.first&.upcase %><%= Current.user&.first_last_name&.first&.upcase %>
        </span>
      </div>
      <div class="sidebar-user-info" data-sidebar-target="collapsible">
        <span class="sidebar-user-name"><%= Current.user&.first_name %> <%= Current.user&.first_last_name&.first&.upcase %></span>
        <span class="sidebar-user-role">
          <%= Current.user&.super_admin? ? "Super Admin" : "Usuario" %>
        </span>
      </div>
      <%= link_to session_path, data: { turbo_method: :delete }, class: "sidebar-logout-btn", title: "Cerrar sesión" do %>
        <%= sidebar_icon("log-out", class: "w-[18px] h-[18px]", stroke: "#EF4444") %>
      <% end %>
    </div>

  </div>
</aside>
